<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Play Chess Online Free (2025) - Strategy vs AI Bot | GameVerse</title>
    <script type="text/javascript">
	atOptions = {
		'key' : 'b738e09d724570089c949e7d60c0f63b',
		'format' : 'iframe',
		'height' : 50,
		'width' : 320,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/b738e09d724570089c949e7d60c0f63b/invoke.js"></script>
    <script type="text/javascript">
	atOptions = {
		'key' : 'b738e09d724570089c949e7d60c0f63b',
		'format' : 'iframe',
		'height' : 50,
		'width' : 320,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/b738e09d724570089c949e7d60c0f63b/invoke.js"></script>
    

    <!-- SEO Meta Tags - Optimized for 2025 -->
    <meta name="description" content="Challenge your strategic mind with GameVerse's free online Chess game (2025 Edition)! Play against our intelligent AI bot (Easy, Medium, Hard) or a friend. Learn rules, master tactics, and enjoy customizable themes. No downloads needed!">
    <meta name="keywords" content="play chess online, free chess game, online chess, chess bot, ai chess, chess strategy, chess rules, chess tactics, play chess vs computer, board games online, strategy games, GameVerse chess, Kanhaiya Mishra, 2025 chess game">
    <meta name="author" content="Kanhaiya Mishra - GameVerse">
    <link rel="canonical" href="https://online-games-indol.vercel.app/chess_game_page.html"> <!-- UPDATE THIS URL WHEN YOU DEPLOY -->

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://online-games-indol.vercel.app/chess_game_page.html"> <!-- UPDATE THIS URL -->
    <meta property="og:title" content="Play Chess Online Free (2025) - Strategy vs AI Bot | GameVerse">
    <meta property="og:description" content="Master strategy with GameVerse's free online Chess. Play vs AI (Easy, Medium, Hard) or friends. Features themes, checkmate alerts, and detailed guides.">
    <meta property="og:image" content="https://online-games-indol.vercel.app/images/chess-social-preview-2025.png"> <!-- UPDATE or CREATE THIS IMAGE -->

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://online-games-indol.vercel.app/chess_game_page.html"> <!-- UPDATE THIS URL -->
    <meta property="twitter:title" content="Play Chess Online Free (2025) - Strategy vs AI Bot | GameVerse">
    <meta property="twitter:description" content="Master strategy with GameVerse's free online Chess. Play vs AI (Easy, Medium, Hard) or friends. Features themes, checkmate alerts, and detailed guides.">
    <meta property="twitter:image" content="https://online-games-indol.vercel.app/images/chess-social-preview-2025.png"> <!-- UPDATE or CREATE THIS IMAGE -->

    <!-- Favicon (Ensure these files are in your root or update path) -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00adb5"> <!-- Use your accent color -->
    <meta name="msapplication-TileColor" content="#222831"> <!-- Use your nav background color -->
    <meta name="theme-color" content="#222831"> <!-- Use your nav background color -->


    <!-- Google AdSense Script -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8067952496194704"
         crossorigin="anonymous"></script>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- Global Styles & Theme Variables (Copied from your chess game code) --- */
        :root {
            /* Default Theme (Dark Wood from your chess game) */
            --bg-color: #3d2c1d; 
            --text-color: #f5e8d3; 
            --shadow-light: rgba(245, 232, 211, 0.2); 
            --shadow-dark: rgba(0, 0, 0, 0.5);      
            --primary-accent: #e8a14d; 
            --secondary-accent: #8b5a2b; 
            --board-light-sq: #f0d9b5; 
            --board-dark-sq: #b58863;  
            --border-radius: 12px;
            --transition-speed: 0.3s;
            --page-wrapper-bg: #4a3623; 
            --neumorphic-button-bg: #4a3623;
            --neumorphic-button-text: #f5e8d3;
            --neumorphic-button-active-text: #e8a14d;
            --content-bg: #5a422d; 
            --top-nav-bg: #2c1e10; 
            --top-nav-text: #f5e8d3;
            --top-nav-link-hover-bg: #4a3623;
            --gv-primary-accent-footer: var(--primary-accent); /* For footer link consistency */
        }

        body.light-theme {
            --bg-color: #e0e5ec; --text-color: #555; --shadow-light: #ffffff; --shadow-dark: #bec8e4;
            --primary-accent: #007bff; --secondary-accent: #6c757d; --board-light-sq: #f0f0f0; 
            --board-dark-sq: #cccccc; --page-wrapper-bg: #e0e5ec; --neumorphic-button-bg: #e0e5ec;
            --neumorphic-button-text: #555; --neumorphic-button-active-text: #007bff; --content-bg: #e0e5ec;
            --top-nav-bg: #343a40; --top-nav-text: #f8f9fa; --top-nav-link-hover-bg: #4f5459;
            --gv-primary-accent-footer: var(--primary-accent);
        }
        
        body.classic-theme { 
            --bg-color: #f0f2f5; --text-color: #333; --primary-accent: #0066cc; --secondary-accent: #555;
            --board-light-sq: #ebebeb; --board-dark-sq: #b2b2b2; --shadow-light: rgba(0,0,0,0.05); 
            --shadow-dark: rgba(0,0,0,0.15); --page-wrapper-bg: #ffffff; --neumorphic-button-bg: #0066cc; 
            --neumorphic-button-text: #ffffff; --neumorphic-button-active-text: #ffffff; --content-bg: #ffffff;
            --top-nav-bg: #2c3e50; --top-nav-text: #ffffff; --top-nav-link-hover-bg: #34495e;
            --gv-primary-accent-footer: var(--primary-accent);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding-top: 70px; /* Adjusted for consistent nav bar height */
            line-height: 1.7; /* Improved line height for readability */
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
        }

        .top-nav-bar {
            position: fixed; top: 0; left: 0; width: 100%;
            background-color: var(--top-nav-bg); 
            color: var(--top-nav-text); padding: 12px 25px; 
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2); z-index: 1005;
            transition: background-color var(--transition-speed) ease;
            min-height: 50px; /* Ensure consistent height */
        }
        .top-nav-bar .logo a { color: var(--top-nav-text); text-decoration: none; font-size: 1.4em; font-weight: 700; font-family: 'Roboto Slab', serif;}
        .top-nav-bar .nav-links { display: flex; align-items: center; flex-wrap: wrap; } /* Added flex-wrap */
        .top-nav-bar .nav-links a { color: var(--top-nav-text); text-decoration: none; margin-left: 15px; font-size: 0.95em; padding: 6px 10px; border-radius: 5px; transition: background-color 0.2s ease, color 0.2s ease; }
        .top-nav-bar .nav-links a:hover, .top-nav-bar .nav-links a.active { 
            background-color: var(--top-nav-link-hover-bg); 
            color: var(--primary-accent); /* Use primary accent for active link */
        }
        
        #theme-switcher-button {
            background: none; border: 1px solid var(--top-nav-text); color: var(--top-nav-text);
            padding: 5px 10px; font-size: 0.85em; border-radius: calc(var(--border-radius) / 1.5);
            cursor: pointer; margin-left: 15px; transition: all var(--transition-speed);
        }
        #theme-switcher-button:hover { background-color: var(--top-nav-link-hover-bg); }

        .page-wrapper {
            width: 95%; max-width: 1200px; /* Slightly wider for more content */
            background-color: var(--page-wrapper-bg); 
            padding: 25px; border-radius: var(--border-radius);
            box-shadow: 8px 8px 16px var(--shadow-dark), -8px -8px 16px var(--shadow-light);
            margin-top: 20px; margin-bottom: 30px;
            transition: background-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
        }

        .game-title-section { text-align: center; margin-bottom: 30px; }
        .game-title-section h1 { font-size: 2.6em; color: var(--primary-accent); margin-bottom: 10px; font-family: 'Roboto Slab', serif; text-shadow: 1px 1px 2px var(--shadow-dark); transition: color var(--transition-speed) ease;}
        .game-title-section p.subtitle { font-size: 1.15em; color: var(--text-color); opacity: 0.9; transition: color var(--transition-speed) ease;}

        .game-content-layout { display: flex; gap: 30px; flex-wrap: wrap; }
        .game-board-area { 
            flex: 2; /* Give more space to game board area */
            min-width: 380px; display: flex; flex-direction: column; align-items: center;
            background-color: var(--neumorphic-button-bg);
            padding: 20px; border-radius: var(--border-radius);
            box-shadow: inset 5px 5px 10px var(--shadow-dark), inset -5px -5px 10px var(--shadow-light);
            transition: background-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
        }
        
        #start-screen { display: flex; flex-direction: column; align-items: center; text-align: center; padding: 20px 0;}
        #start-screen h2 { margin-bottom: 15px; font-size: 1.6em; color: var(--neumorphic-button-text); }
        #bot-difficulty-selector { margin: 15px 0; display: none; }
        #bot-difficulty-selector label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--neumorphic-button-text); }
        #bot-difficulty-selector select {
            padding: 10px 15px; font-size: 1em; border-radius: calc(var(--border-radius) / 1.5);
            border: 1px solid var(--shadow-dark); background-color: var(--neumorphic-button-bg); color: var(--neumorphic-button-text);
            box-shadow: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light);
            cursor: pointer; appearance: none; -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='%23${encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue('--neumorphic-button-text').trim().substring(1))}' d='M8 11.314l-4.95-4.95.707-.707L8 9.899l4.243-4.242.707.707z'/%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 10px center; background-size: 16px;
            transition: all var(--transition-speed);
        }

        .neumorphic-button {
            display: inline-block; padding: 12px 25px; margin: 10px; font-size: 1.05em; font-weight: 600;
            color: var(--neumorphic-button-text); background-color: var(--neumorphic-button-bg);
            border: none; border-radius: var(--border-radius); cursor: pointer;
            box-shadow: 5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light);
            transition: all var(--transition-speed) ease; text-decoration: none;
        }
        .neumorphic-button.primary { color: var(--primary-accent); }
        .neumorphic-button.success { color: #a0e8a1; } /* Adjusted for dark themes */
        .neumorphic-button.danger { color: #e8a1a1; } /* Adjusted for dark themes */

        .neumorphic-button:hover { opacity: 0.85; transform: translateY(-1px); }
        .neumorphic-button:active {
            box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light);
            color: var(--neumorphic-button-active-text); 
            transform: translateY(1px);
        }

        #game-elements { display: none; flex-direction: column; align-items: center; margin-top: 15px; }
        #chessboard {
            display: grid; grid-template-columns: repeat(8, 48px); grid-template-rows: repeat(8, 48px);
            border-radius: calc(var(--border-radius) / 2);
            box-shadow: 5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light);
            overflow: hidden; 
        }
        .square { width: 48px; height: 48px; display: flex; justify-content: center; align-items: center; font-size: 36px; cursor: pointer; user-select: none; transition: background-color 0.2s; }
        .square.light { background-color: var(--board-light-sq); }
        .square.dark { background-color: var(--board-dark-sq); }
        .piece { pointer-events: none; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); }
        
        .selected { background-color: #a0c0f0cc !important; } /* Keep distinct selection color */
        .valid-move::after { content: ''; display: block; width: 14px; height: 14px; background-color: rgba(40, 167, 69, 0.7); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .valid-capture::after { content: ''; display: block; width: calc(100% - 10px); height: calc(100% - 10px); border: 5px solid rgba(220, 53, 69, 0.7); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); box-sizing: border-box; }
        .valid-move, .valid-capture {position: relative;}

        #status {
            margin-top: 20px; font-size: 1.2em; font-weight: 600; padding: 10px 20px;
            border-radius: var(--border-radius); text-align: center; min-width: 200px;
            background-color: var(--neumorphic-button-bg); 
            color: var(--neumorphic-button-text); 
            box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light);
            transition: all var(--transition-speed);
        }
        .status-bot-thinking { color: #ffdc73; } 
        .status-game-over { color: var(--secondary-accent); }

        .game-buttons { margin-top: 15px; display:flex; flex-wrap:wrap; justify-content:center; } /* Flex for button layout */
        #back-button { margin-top: 10px; }

        .custom-popup, #promotion-popup {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background-color: var(--page-wrapper-bg); 
            color: var(--text-color);
            padding: 25px; border-radius: var(--border-radius);
            box-shadow: 8px 8px 16px var(--shadow-dark), -8px -8px 16px var(--shadow-light);
            z-index: 1001; text-align: center;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            max-width: 90%; width: 350px; /* Popup width */
        }
        .custom-popup p, #promotion-popup p { margin-bottom: 15px; font-size: 1.1em; }
        .promotion-options button { font-size: 40px; background: none; border:none; cursor: pointer; padding: 10px; margin: 0 5px; border-radius: calc(var(--border-radius)/2); transition: all var(--transition-speed); color: var(--text-color);}
        .promotion-options button:hover { color: var(--primary-accent); transform: scale(1.1); }

        .game-description-wrapper { flex: 3; min-width: 320px; } /* Give more space to description */
        .game-description-content {
            padding: 30px; background-color: var(--content-bg); color: var(--text-color);
            border-radius: var(--border-radius);
            box-shadow: 5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light);
            line-height: 1.8; text-align: left;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
        }
        .game-description-content h2 { font-size: 2.0em; color: var(--primary-accent); margin-top: 0; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid var(--primary-accent); font-family: 'Roboto Slab', serif; transition: color var(--transition-speed) ease, border-color var(--transition-speed) ease;}
        .game-description-content h3 { font-size: 1.6em; color: var(--secondary-accent); margin-top: 25px; margin-bottom: 12px; font-family: 'Roboto Slab', serif; transition: color var(--transition-speed) ease;}
        .game-description-content p, .game-description-content ul, .game-description-content ol { margin-bottom: 18px; font-size: 1.05em; }
        .game-description-content ul, .game-description-content ol { padding-left: 30px; } 
        .game-description-content ul li { list-style-type: '♟ '; margin-bottom: 10px; padding-left: 5px; } 
        .game-description-content ol li { list-style-type: decimal; margin-bottom: 10px; }
        .game-description-content strong { font-weight: 600; color: var(--primary-accent); transition: color var(--transition-speed) ease;}
        .game-description-content .highlight { color: var(--primary-accent); font-weight: bold;}
        .game-description-content .game-feature-list li { list-style-type: '◉ '; margin-top: 8px; }


        .site-footer {
            text-align: center; padding: 25px 0; margin-top: auto; /* Push footer to bottom */
            width:100%; background-color: var(--top-nav-bg); 
            color: var(--top-nav-text); opacity: 0.95; font-size: 0.9em;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
            border-top: 3px solid var(--gv-primary-accent-footer);
        }
        .site-footer a { color: var(--gv-primary-accent-footer); text-decoration: none; font-weight: 500;}
        .site-footer a:hover { text-decoration: underline; color: #fff;}
        .footer-links-group { margin-top: 8px; margin-bottom: 15px; }
        .footer-links-group a { margin: 0 8px; }
        .footer-social-links { 
            margin-top: 15px; padding-top: 15px; border-top: 1px solid #444; 
        }
        .footer-social-links p {
             margin-bottom: 10px; font-size: 1em; font-weight: 500; color: var(--top-nav-text);
        }
        .footer-social-links a { display: inline-block; margin: 0 10px; transition: transform 0.2s ease; }
        .footer-social-links img { width: 32px; height: 32px; vertical-align: middle; }
        .footer-social-links a:hover { transform: scale(1.15); text-decoration: none; }


        @media (max-width: 900px) { /* Adjust breakpoint for layout change */
             .game-content-layout { flex-direction: column; } 
             .game-board-area, .game-description-wrapper { min-width: 100%; flex: none; } 
        }
        @media (max-width: 480px) { 
            body {padding-top: 100px;} /* Adjust for taller nav on mobile when it wraps */
            .top-nav-bar { padding: 10px 15px; flex-direction: column; align-items: flex-start; gap: 8px; height: auto; padding-bottom: 8px;} 
            .top-nav-bar .logo a { font-size: 1.3em; } 
            .top-nav-bar .nav-links { margin-top:5px; justify-content: flex-start; width:100%;} 
            .top-nav-bar .nav-links a { margin-left: 0; margin-right: 10px; font-size: 0.9em; } 
            #theme-switcher-button { font-size:0.75em; padding: 4px 8px; margin-left: auto; /* Push to right */} 
            .page-wrapper { padding: 15px; } 
            .game-title-section h1 { font-size: 2em; } 
            #chessboard { grid-template-columns: repeat(8, min(11vw, 40px)); grid-template-rows: repeat(8, min(11vw, 40px)); } /* Responsive chessboard cells */
            .square { width: min(11vw, 40px); height: min(11vw, 40px); font-size: min(8vw, 30px); } /* Responsive pieces */
            .game-description-content h2 { font-size: 1.6em; } 
            .game-description-content h3 { font-size: 1.3em; } 
            .footer-social-links img { width: 28px; height: 28px;}
        }

    </style>
</head>
<body>
    <nav class="top-nav-bar">
        <div class="logo"><a href="index.html">GameVerse</a></div>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="about.html">About Us</a>
            <a href="contact.html">Contact Us</a>
            <a href="privacy_policy.html">Privacy Policy</a>
            <a href="terms.html">Terms of Service</a>
            <button id="theme-switcher-button">Change Theme</button>
        </div>
    </nav>

    <div class="page-wrapper">
        <section class="game-title-section">
            <h1>Online Chess Master: Free Strategy Board Game (2025)</h1>
            <p class="subtitle">Challenge our intelligent AI (Easy, Medium, Hard) or play a classic game against a friend. Sharpen your tactical skills, learn openings, and master the art of checkmate in this timeless brain game. Updated for a premium 2025 experience on GameVerse!</p>
        </section>

        <div class="game-content-layout">
            <section class="game-board-area">
                <div id="start-screen">
                    <h2>Choose Your Opponent</h2>
                    <div id="bot-difficulty-selector">
                        <label for="difficulty">Select Bot Skill Level:</label>
                        <select id="difficulty">
                            <option value="easy">Easy (Learning Mode)</option>
                            <option value="medium" selected>Medium (Challenger AI)</option>
                            <option value="hard">Hard (Grandmaster AI)</option>
                        </select>
                    </div>
                    <div>
                        <button id="play-friend-button" class="neumorphic-button primary">Play vs Friend (2 Player)</button>
                        <button id="play-bot-initial-button" class="neumorphic-button success">Play vs Smart Bot</button>
                        <button id="start-game-bot-final" class="neumorphic-button danger" style="display:none;">Start AI Battle!</button>
                    </div>
                </div>

                <div id="game-elements">
                    <div id="chessboard"></div>
                    <div id="status">White's Turn</div>
                    <div class="game-buttons">
                        <button id="reset-button" class="neumorphic-button">Reset Game</button>
                        <button id="share-button" class="neumorphic-button success">Share Game</button>
                    </div>
                    <button id="back-button" class="neumorphic-button">Back to Menu</button>
                </div>

                <div id="custom-alert-popup" class="custom-popup" style="display: none;">
                    <p id="custom-alert-message"></p>
                    <button id="custom-alert-ok-button" class="neumorphic-button primary">OK</button>
                </div>
                <div id="promotion-popup" style="display: none;">
                    <p>Promote Pawn To:</p>
                    <div class="promotion-options">
                        <button data-promote="q">♕</button> <button data-promote="r">♖</button>
                        <button data-promote="b">♗</button> <button data-promote="n">♘</button>
                    </div>
                </div>
            </section>

            <section class="game-description-wrapper">
                <article class="game-description-content">
                    <h2>Master the Royal Game: Online Chess at GameVerse</h2>
                    <p>Welcome to the definitive online chess experience at GameVerse, meticulously crafted by Kanhaiya Mishra for chess enthusiasts of all levels! Chess, often hailed as the "game of kings," is a profound test of intellect, strategy, and foresight that has captivated minds for centuries. Whether you are a curious beginner eager to learn the fundamental rules and piece movements, an intermediate player looking to refine your tactical combinations, or a seasoned grandmaster aiming to hone your endgame precision, our platform offers a stimulating, accessible, and thoroughly enjoyable environment. <span class="highlight">Play chess online for free</span>, instantly in your browser, with no downloads required – perfect for a quick mental workout or an extended strategic battle.</p>
                    
                    <h3>How to Play Chess: A Comprehensive Guide for Beginners</h3>
                    <p>The ultimate objective in chess is to achieve <strong class="highlight">checkmate</strong> against your opponent's King. This occurs when the King is under direct attack (in "check") and has no legal moves to escape the threat. The game is played on an 8x8 checkered board with 64 squares, alternating between light and dark colors. Each player commands an army of 16 pieces: one King, one Queen, two Rooks, two Bishops, two Knights, and eight Pawns.</p>
                    <ol>
                        <li><strong>Setup:</strong> The board is set up with each player's pieces arranged on their respective first two ranks (rows). The second rank is filled with Pawns. The first rank, from left to right (for White), typically holds: Rook, Knight, Bishop, Queen, King, Bishop, Knight, Rook. The White Queen always starts on a light square (d1), and the Black Queen on a dark square (d8).</li>
                        <li><strong>Turns & Movement:</strong> White always makes the first move, after which players alternate turns. On each turn, a player must move one of their pieces to a different square, following the specific movement rules for that piece type. A piece can capture an opponent's piece by moving onto the square it occupies, removing the captured piece from the board.</li>
                        <li><strong>Piece Movements:</strong> Understanding how each piece moves is fundamental:
                            <ul>
                                <li><strong>King (♔♚):</strong> Moves one square in any direction (horizontally, vertically, or diagonally). The King is the most important piece; losing it means losing the game.</li>
                                <li><strong>Queen (♕♛):</strong> The most powerful piece, it can move any number of unoccupied squares in any straight line (horizontally, vertically, or diagonally).</li>
                                <li><strong>Rook (♖♜):</strong> Moves any number of unoccupied squares horizontally or vertically.</li>
                                <li><strong>Bishop (♗♝):</strong> Moves any number of unoccupied squares diagonally. Each player starts with one Bishop on light squares and one on dark squares; they always remain on squares of their starting color.</li>
                                <li><strong>Knight (♘♞):</strong> Moves in an "L" shape: two squares in one direction (horizontal or vertical) and then one square perpendicular to that. The Knight is the only piece that can jump over other pieces.</li>
                                <li><strong>Pawn (♙♟):</strong> The most complex piece in terms of movement. Pawns move one square forward (never backward). On their very first move, a Pawn has the option to move one OR two squares forward. Pawns capture diagonally forward one square.</li>
                            </ul>
                        </li>
                        <li><strong>Special Moves:</strong>
                            <ul>
                                <li><strong>Castling:</strong> A special defensive move involving the King and one of the Rooks. It allows the King to move two squares towards a Rook, and that Rook to move to the square on the other side of the King, all in one turn. Certain conditions must be met: neither the King nor the Rook involved can have moved previously, there must be no pieces between them, the King cannot be in check, nor can it pass through or land on a square attacked by an enemy piece.</li>
                                <li><strong>En Passant:</strong> A rare but important Pawn capture. If an opponent's Pawn moves two squares forward from its starting position and lands beside your Pawn, your Pawn has the option, on your very next turn only, to capture the opponent's Pawn "in passing" as if it had only moved one square. Your Pawn moves to the square the opponent's Pawn skipped over.</li>
                                <li><strong>Pawn Promotion:</strong> If a Pawn reaches the opponent's back rank (the furthest row), it must be immediately promoted to another piece of the same color (Queen, Rook, Bishop, or Knight, but not another King). Usually, players promote to a Queen due to its power. Our game provides an easy interface for this.</li>
                            </ul>
                        </li>
                        <li><strong>Check and Checkmate:</strong> If a King is attacked, it is in "check." The player whose King is in check must make a move to get out of check (by moving the King, blocking the check, or capturing the attacking piece). If no such move is possible, it is "checkmate," and the game ends.</li>
                        <li><strong>Draws:</strong> A game can also end in a draw in several ways: Stalemate (player whose turn it is has no legal moves, but their King is NOT in check), agreement between players, threefold repetition of a position, or the fifty-move rule (no captures or Pawn moves in 50 consecutive moves by each player).</li>
                    </ol>

                    <h3>Features of GameVerse Chess (2025 Edition)</h3>
                    <ul class="game-feature-list">
                        <li><strong>Intelligent AI Bot:</strong> Challenge our sophisticated chess bot with adjustable skill levels.
                            <ul>
                                <li><strong>Easy (Learning Mode):</strong> Perfect for new players to grasp the basics and practice elementary tactics without overwhelming pressure.</li>
                                <li><strong>Medium (Challenger AI):</strong> A balanced AI that provides a good challenge for intermediate players, capable of recognizing common patterns and executing basic plans.</li>
                                <li><strong>Hard (Grandmaster AI):</strong> A formidable opponent that employs advanced strategies, deep calculation, and positional understanding. Beating this AI is a true test of skill!</li>
                            </ul>
                        </li>
                        <li><strong>Play vs. Friend (2 Player):</strong> Enjoy a classic two-player game with a friend on the same device. Pass and play, strategizing face-to-face.</li>
                        <li><strong>Multiple Themes:</strong> Customize your playing experience! Choose from Dark Wood, Light Neumorphic, or Classic themes to suit your visual preference. Your theme choice is saved.</li>
                        <li><strong>Sleek & Modern User Interface:</strong> A clean, intuitive, and visually appealing interface designed for easy navigation and an enjoyable gaming experience.</li>
                        <li><strong>Clear Move Indication:</strong> Selected pieces and valid moves are clearly highlighted, making it easy to see your options.</li>
                        <li><strong>Pawn Promotion UI:</strong> When a pawn reaches the eighth rank, a simple and clear interface allows you to choose your desired promotion piece (Queen, Rook, Bishop, or Knight).</li>
                        <li><strong>Helpful Game Status & Alerts:</strong> Always know whose turn it is. Receive clear visual and pop-up alerts for "Check," "Checkmate," and "Stalemate/Draw" conditions, ensuring you never miss a critical game state.</li>
                        <li><strong>No Downloads, Instant Play:</strong> Access the game directly in your web browser on any compatible device without the need for installation or plugins.</li>
                        <li><strong>Responsive Design:</strong> Play seamlessly on your desktop, laptop, tablet, or mobile phone. The board and controls adapt to your screen size.</li>
                        <li><strong>Share Your Game:</strong> Easily share a link to the game with friends via WhatsApp.</li>
                    </ul>

                    <h3>Winning Strategies & Tips for Chess Improvement</h3>
                    <p>Improving at chess is a lifelong journey of learning and practice. Here are some fundamental tips to elevate your game:</p>
                    <ul>
                        <li><strong>Control the Center:</strong> Dominating the central squares (d4, e4, d5, e5) with your pieces and pawns often gives you more mobility and influence over the board.</li>
                        <li><strong>Develop Your Pieces Early:</strong> Bring your Knights and Bishops out from their starting squares early in the game ("opening phase") towards active positions, usually aiming at the center. Avoid moving the same piece multiple times in the opening unless necessary.</li>
                        <li><strong>King Safety:</strong> Prioritize your King's safety, especially in the opening and middlegame. Castling is usually a good way to achieve this. An exposed King can quickly become a target.</li>
                        <li><strong>Piece Value & Material:</strong> Be mindful of the relative values of pieces (Pawn=1, Knight/Bishop=3, Rook=5, Queen=9). Avoid losing valuable pieces for less valuable ones without good compensation (like a strong attack or positional advantage).</li>
                        <li><strong>Think Before You Move:</strong> Consider your opponent's possible replies to your move. Ask yourself, "What is my opponent trying to do?" and "What are the threats?"</li>
                        <li><strong>Look for Tactics:</strong> Chess is full of tactical motifs like forks (one piece attacking two enemy pieces simultaneously), pins (a piece cannot move because it would expose a more valuable piece behind it), skewers, discovered attacks, etc. Practice recognizing these patterns.</li>
                        <li><strong>Plan Ahead:</strong> Don't just play one move at a time. Try to formulate a simple plan, even if it's just for the next few moves. What are you trying to achieve?</li>
                        <li><strong>Endgame Knowledge:</strong> Basic endgame principles (like King activity, pawn promotion, creating passed pawns) are crucial. Even a small material advantage can often be converted into a win in the endgame with correct play.</li>
                        <li><strong>Analyze Your Games:</strong> After playing, review your game (especially losses) to identify mistakes and learn from them. What could you have done differently?</li>
                        <li><strong>Practice Regularly:</strong> The more you play and study, the better you'll become. Consistency is key!</li>
                    </ul>
                    <p>Ready to make your move and test your strategic acumen? <span class="highlight">Start a new chess game online now</span> on GameVerse and embark on your journey to chess mastery! Whether you seek a casual pastime or a serious mental challenge, our platform is here for you.</p>
                </article>
            </section>
        </div>
    </div>

    <footer class="site-footer">
        <p>© <span id="currentYear"></span> GameVerse by Kanhaiya Mishra. All Rights Reserved.</p>
        <div class="footer-links-group">
            <a href="index.html">Home</a> | 
            <a href="about.html">About Us</a> | 
            <a href="contact.html">Contact Us</a> | 
            <a href="privacy_policy.html">Privacy Policy</a> |
            <a href="terms.html">Terms of Service</a>
        </div>
        <div class="footer-social-links">
            <p>Follow Us for GameVerse Updates:</p>
            <a href="https://t.me/PraxAI" target="_blank" rel="noopener noreferrer" title="PraxAI on Telegram">
                <img src="telegram-icon.png" alt="Telegram Icon for GameVerse">
            </a>
            <a href="https://youtube.com/@praxai?si=SrIQNBLVw79p9oKD" target="_blank" rel="noopener noreferrer" title="PraxAI on YouTube">
                <img src="youtube-icon.png" alt="YouTube Icon for GameVerse">
            </a>
            <a href="https://whatsapp.com/channel/0029Vb30cphDjiOZoEQf9a20" target="_blank" rel="noopener noreferrer" title="Gyan Natraj on WhatsApp">
                <img src="whatsapp-icon.png" alt="WhatsApp Channel Icon for GameVerse">
            </a>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <script>
        // === START OF JAVASCRIPT (NO CHANGES MADE TO THIS SECTION) ===
        let game = new Chess();
        let selectedSquare = null;
        let validMoves = [];
        let gameMode = null; 
        let isBotThinking = false;
        let botTimeoutId = null;
        let awaitingPromotion = false;
        let promotionDetails = null; 
        let currentBotDifficulty = 'medium'; 
        let searchDepth = 2; 

        let moveSound = null;
        let backgroundMusic = null; 
        let musicPlayed = false; 

        const chessboardElement = document.getElementById('chessboard');
        const statusElement = document.getElementById('status');
        const resetGameButton = document.getElementById('reset-button');
        const shareButton = document.getElementById('share-button');
        const backButton = document.getElementById('back-button');
        const startScreen = document.getElementById('start-screen');
        const gameElements = document.getElementById('game-elements');
        const playFriendButton = document.getElementById('play-friend-button');
        const playBotInitialButton = document.getElementById('play-bot-initial-button');
        const botDifficultySelectorDiv = document.getElementById('bot-difficulty-selector');
        const difficultySelect = document.getElementById('difficulty');
        const startGameBotFinalButton = document.getElementById('start-game-bot-final');
        const customAlertPopup = document.getElementById('custom-alert-popup');
        const customAlertMessageElement = document.getElementById('custom-alert-message');
        const customAlertOkButton = document.getElementById('custom-alert-ok-button');
        let customAlertTimeoutId = null;
        const promotionPopup = document.getElementById('promotion-popup');
        const promotionOptionsElement = promotionPopup.querySelector('.promotion-options');
        
        const themeSwitcherButton = document.getElementById('theme-switcher-button'); 
        let currentThemeIndex = 0; 
        const themes = ['default-theme', 'light-theme', 'classic-theme']; 

        const piecesUnicode = { 
            wP: '♙', wR: '♖', wN: '♘', wB: '♗', wQ: '♕', wK: '♔',
            bP: '♟', bR: '♜', bN: '♞', bB: '♝', bQ: '♛', bK: '♚'
        };
        const pieceValues = { 
            p: 100, n: 320, b: 330, r: 500, q: 900, k: 20000 
        };
        const pawnEvalWhite = [[0,0,0,0,0,0,0,0],[50,50,50,50,50,50,50,50],[10,10,20,30,30,20,10,10],[5,5,10,25,25,10,5,5],[0,0,0,20,20,0,0,0],[5,-5,-10,0,0,-10,-5,5],[5,10,10,-20,-20,10,10,5],[0,0,0,0,0,0,0,0]];
        const knightEval = [[-50,-40,-30,-30,-30,-30,-40,-50],[-40,-20,0,0,0,0,-20,-40],[-30,0,10,15,15,10,0,-30],[-30,5,15,20,20,15,5,-30],[-30,0,15,20,20,15,0,-30],[-30,5,10,15,15,10,5,-30],[-40,-20,0,5,5,0,-20,-40],[-50,-40,-30,-30,-30,-30,-40,-50]];
        const createEmptyEvalTable = () => new Array(8).fill(0).map(() => new Array(8).fill(0));
        const bishopEval = createEmptyEvalTable(); // Simplified for brevity, real eval tables are more complex
        const rookEval = createEmptyEvalTable();
        const queenEval = createEmptyEvalTable();
        const kingEvalMiddleGame = createEmptyEvalTable(); 
        const kingEvalEndGame = createEmptyEvalTable(); 

        function applyTheme(themeClassName) {
            document.body.className = ''; 
            if (themeClassName !== 'default-theme') {
                 document.body.classList.add(themeClassName);
            }
            localStorage.setItem('chessGameTheme', themeClassName);
            const selectArrowColorElement = document.getElementById('difficulty'); // Target the select element
            if (selectArrowColorElement) {
                const currentTextColor = getComputedStyle(selectArrowColorElement).color;
                // Basic approach: encode the color value directly.
                // More robust: parse color (e.g. rgb(x,y,z) to hex #RRGGBB if SVG needs hex)
                // For simplicity, this assumes the color format is directly usable or that SVG handles various formats.
                // If --neumorphic-button-text resolves to a CSS variable name, this needs to be handled.
                // Assuming it resolves to a color value:
                 difficultySelect.style.backgroundImage = `url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='${encodeURIComponent(currentTextColor)}' d='M8 11.314l-4.95-4.95.707-.707L8 9.899l4.243-4.242.707.707z'/%3E%3C/svg%3E")`;
            }
        }

        themeSwitcherButton.addEventListener('click', () => {
            currentThemeIndex = (currentThemeIndex + 1) % themes.length;
            applyTheme(themes[currentThemeIndex]);
        });

        function loadSavedTheme() {
            const savedTheme = localStorage.getItem('chessGameTheme');
            if (savedTheme && themes.includes(savedTheme)) {
                currentThemeIndex = themes.indexOf(savedTheme);
                applyTheme(savedTheme);
            } else {
                applyTheme(themes[0]); 
            }
        }

        function getPositionalValue(piece, r, c) {  
            const row = piece.color === 'w' ? 7 - r : r; 
            const col = c;
            if (row < 0 || row > 7 || col < 0 || col > 7) return 0;
            switch (piece.type) {
                case 'p': return pawnEvalWhite[row][col]; 
                case 'n': return knightEval[row][col];
                case 'b': return bishopEval[row][col]; // Using simplified table
                case 'r': return rookEval[row][col]; // Using simplified table
                case 'q': return queenEval[row][col]; // Using simplified table
                // Simplified king eval, real game would differentiate mid/end game
                case 'k': return (game.history().length > 40 ? kingEvalEndGame[row][col] : kingEvalMiddleGame[row][col]); 
                default: return 0;
            }
        }
        function evaluateBoard(boardInstance) { 
            let totalEvaluation = 0;
            const boardState = boardInstance.board(); 
            for (let r = 0; r < 8; r++) { 
                for (let c = 0; c < 8; c++) { 
                    const piece = boardState[r][c];
                    if (piece) {
                        let pieceVal = pieceValues[piece.type];
                        let positionalVal = getPositionalValue(piece, r, c); 
                        totalEvaluation += (pieceVal + positionalVal) * (piece.color === 'w' ? 1 : -1);
                    }
                }
            }
            return totalEvaluation;
        }
        function minimax(boardInstance, depth, alpha, beta, maximizingPlayer, isEasyMode) { 
            if (depth === 0 || boardInstance.game_over()) {
                if (boardInstance.in_checkmate()) return maximizingPlayer ? -Infinity : Infinity; 
                return evaluateBoard(boardInstance);
            }
            const moves = boardInstance.moves({ verbose: true });
            if (moves.length === 0) return 0; 
            if (isEasyMode && depth > 0 && Math.random() < 0.4) { 
                 const randomMove = moves[Math.floor(Math.random() * moves.length)];
                 boardInstance.move(randomMove);
                 const evalResult = minimax(boardInstance, 0, alpha, beta, !maximizingPlayer, false); 
                 boardInstance.undo();
                 return evalResult;
            }
            if (maximizingPlayer) { 
                let maxEval = -Infinity;
                for (const move of moves) {
                    boardInstance.move(move);
                    const evalResult = minimax(boardInstance, depth - 1, alpha, beta, false, isEasyMode);
                    boardInstance.undo();
                    maxEval = Math.max(maxEval, evalResult);
                    alpha = Math.max(alpha, evalResult);
                    if (beta <= alpha) break;
                }
                return maxEval;
            } else { 
                let minEval = Infinity;
                for (const move of moves) {
                    boardInstance.move(move);
                    const evalResult = minimax(boardInstance, depth - 1, alpha, beta, true, isEasyMode);
                    boardInstance.undo();
                    minEval = Math.min(minEval, evalResult);
                    beta = Math.min(beta, evalResult);
                    if (beta <= alpha) break;
                }
                return minEval;
            }
        }
        function getBestMoveForBot(boardInstance, difficulty) { 
            const possibleMoves = boardInstance.moves({ verbose: true });
            if (possibleMoves.length === 0) return null;
            let bestMove = null;
            let bestValue; 

            if (difficulty === 'easy') {
                if (Math.random() < 0.7) { 
                    return possibleMoves[Math.floor(Math.random() * possibleMoves.length)];
                }
                // For easy, bot (black) wants to MINIMIZE white's score from its perspective
                bestValue = Infinity; 
                 for (const move of possibleMoves) {
                    boardInstance.move(move);
                    // Evaluate from White's perspective (maximizingPlayer = true for White's turn after bot moves)
                    const boardValue = minimax(boardInstance, 0, -Infinity, Infinity, true, true); 
                    boardInstance.undo();
                    if (boardValue < bestValue ) { 
                        bestValue = boardValue;
                        bestMove = move;
                    }
                }
                return bestMove || possibleMoves[0]; 
            }
            
            // For medium/hard, bot (black) wants to MINIMIZE white's score
            bestValue = Infinity; 
            possibleMoves.sort(() => Math.random() - 0.5); // Add some randomness for variety
            for (const move of possibleMoves) {
                boardInstance.move(move);
                // After bot (black) moves, it will be white's turn, so we evaluate for white (maximizingPlayer = true)
                const boardValue = minimax(boardInstance, searchDepth -1, -Infinity, Infinity, true, false);
                boardInstance.undo();
                if (boardValue < bestValue) {
                    bestValue = boardValue;
                    bestMove = move;
                }
            }
            return bestMove;
        }
        function makeBotMove() { 
            if (game.game_over() || game.turn() !== 'b' || isBotThinking || awaitingPromotion) return;
            isBotThinking = true;
            updateStatus();
            if (botTimeoutId) clearTimeout(botTimeoutId);
            botTimeoutId = setTimeout(() => {
                const bestMove = getBestMoveForBot(game, currentBotDifficulty);
                if (bestMove) {
                    game.move(bestMove);
                }
                isBotThinking = false;
                afterMove(); 
            }, 50 + Math.random() * 200); // Slight random delay
        }
        function setSearchDepthForDifficulty(difficulty) { 
            currentBotDifficulty = difficulty;
            if (difficulty === 'easy') searchDepth = 0; 
            else if (difficulty === 'hard') searchDepth = 2; 
            else searchDepth = 1; 
        }
        function squareToCoords(squareName) { 
            const col = squareName.charCodeAt(0) - 'a'.charCodeAt(0);
            const row = 8 - parseInt(squareName[1]); 
            return { row, col };
        }
        function coordsToSquare(r, c) { 
             return String.fromCharCode('a'.charCodeAt(0) + c) + (8 - r);
        }
        function createBoardHTML() { 
            chessboardElement.innerHTML = '';
            for (let r = 0; r < 8; r++) { 
                for (let c = 0; c < 8; c++) { 
                    const squareElement = document.createElement('div');
                    squareElement.classList.add('square', (r + c) % 2 === 0 ? 'light' : 'dark');
                    squareElement.dataset.square = coordsToSquare(r, c);
                    squareElement.addEventListener('click', handleSquareClick);
                    chessboardElement.appendChild(squareElement);
                }
            }
        }
        function renderBoard() { 
            const board = game.board(); 
            chessboardElement.querySelectorAll('.square').forEach(sqEl => {
                const squareName = sqEl.dataset.square;
                const coords = squareToCoords(squareName); 
                sqEl.innerHTML = ''; 
                sqEl.classList.remove('selected', 'valid-move', 'valid-capture');
                const piece = board[coords.row][coords.col]; 
                if (piece) {
                    const pieceEl = document.createElement('div');
                    pieceEl.classList.add('piece');
                    pieceEl.textContent = piecesUnicode[piece.color + piece.type.toUpperCase()];
                    sqEl.appendChild(pieceEl);
                }
                if (selectedSquare && selectedSquare === squareName) {
                    sqEl.classList.add('selected');
                }
                if (validMoves.some(m => m.to === squareName)) {
                    const targetPiece = game.get(squareName);
                    sqEl.classList.add(targetPiece ? 'valid-capture' : 'valid-move');
                }
            });
            updateStatus();
        }
        function updateStatus() { 
            statusElement.classList.remove('status-white-turn', 'status-black-turn', 'status-bot-thinking', 'status-game-over');
            if (game.game_over()) { 
                let message = "Game Over"; 
                if (game.in_checkmate()) message = `Checkmate! ${game.turn() === 'w' ? 'Black' : 'White'} Wins!`;
                else if (game.in_stalemate()) message = "Stalemate (Draw)";
                else if (game.in_draw()) message = "Draw by Repetition/Material/50-move rule";
                statusElement.textContent = message; 
                statusElement.classList.add('status-game-over');
            } else if (isBotThinking) {
                statusElement.textContent = "Bot is Strategizing...";
                statusElement.classList.add('status-bot-thinking');
            } else if (awaitingPromotion) {
                statusElement.textContent = "Promote Your Pawn!";
                statusElement.classList.add(game.turn() === 'w' ? 'status-white-turn' : 'status-black-turn');
            } else {
                statusElement.textContent = `${game.turn() === 'w' ? 'White' : 'Black'}'s Turn to Move`;
                statusElement.classList.add(game.turn() === 'w' ? 'status-white-turn' : 'status-black-turn');
            }
        }
        function initializeSound(soundVar, fileName, loop = false, volume = 0.7) { 
            if (!soundVar) {
                try {
                    soundVar = new Audio(fileName); 
                    soundVar.loop = loop;
                    soundVar.volume = volume;
                    soundVar.onerror = () => console.error(`Error loading sound '${fileName}'`);
                } catch (e) {
                    console.error(`Failed to initialize Audio for ${fileName}:`, e);
                    return null; 
                }
            }
            return soundVar;
        }
        function startGame(mode) { 
            gameMode = mode;
            if (gameMode === 'bot') {
                setSearchDepthForDifficulty(difficultySelect.value);
            }
            game = new Chess();
            selectedSquare = null;
            validMoves = [];
            isBotThinking = false;
            awaitingPromotion = false;
            promotionDetails = null;
            if (botTimeoutId) clearTimeout(botTimeoutId);
            
            moveSound = initializeSound(moveSound, 'step.mp3'); 

            renderBoard();
            promotionPopup.style.display = 'none';
            customAlertPopup.style.display = 'none'; 
            startScreen.style.display = 'none';
            gameElements.style.display = 'flex';
        }
        function resetCurrentBoard() {  
            game = new Chess(); 
            selectedSquare = null;
            validMoves = [];
            isBotThinking = false;
            awaitingPromotion = false;
            promotionDetails = null;
            if (botTimeoutId) clearTimeout(botTimeoutId);
            renderBoard(); 
            promotionPopup.style.display = 'none';
            customAlertPopup.style.display = 'none';
        }
        function goBackToMainMenu() { 
            gameMode = null;
            if (botTimeoutId) clearTimeout(botTimeoutId);
            isBotThinking = false;
            gameElements.style.display = 'none';
            customAlertPopup.style.display = 'none';
            startScreen.style.display = 'flex';
            botDifficultySelectorDiv.style.display = 'none';
            playBotInitialButton.style.display = 'inline-block';
            startGameBotFinalButton.style.display = 'none';
            playFriendButton.style.display = 'inline-block';
            statusElement.textContent = ""; 
            statusElement.className = "";
        }
        
        function showCustomAlert(message, duration = 3500, isError = false) { 
            if (customAlertTimeoutId) clearTimeout(customAlertTimeoutId);
            customAlertMessageElement.textContent = message;
            customAlertPopup.style.display = 'block';
            customAlertPopup.style.backgroundColor = isError ? 'var(--secondary-accent)' : 'var(--page-wrapper-bg)'; // Error color
            
            if (message.toLowerCase().includes('wins') || message.toLowerCase().includes('draw')) {
                // Game end messages, wait for OK
            } else {
                 customAlertTimeoutId = setTimeout(() => {
                    customAlertPopup.style.display = 'none';
                }, duration);
            }
        }
        customAlertOkButton.addEventListener('click', () => { 
            if (customAlertTimeoutId) clearTimeout(customAlertTimeoutId);
            customAlertPopup.style.display = 'none';
        });
        
        function afterMove() { 
            if (moveSound && moveSound.readyState === 4) { // Check if sound is loaded
                const soundClone = moveSound.cloneNode(); 
                soundClone.currentTime = 0; 
                soundClone.play().catch(e => {/* ignore */});
            }
            renderBoard(); 
            updateStatus(); 

            if (game.in_checkmate()) {
                showCustomAlert(`Checkmate! ${game.turn() === 'w' ? 'Black' : 'White'} wins!`);
            } else if (game.in_draw()) {
                 let drawMsg = "Draw!";
                 if (game.in_stalemate()) drawMsg = "Stalemate! (Draw)";
                 else if (game.in_threefold_repetition()) drawMsg = "Draw by Threefold Repetition!";
                 else if (game.insufficient_material()) drawMsg = "Draw by Insufficient Material!";
                 else if (game.half_moves >= 100 ) drawMsg = "Draw by 50-move rule!"; // chess.js uses half_moves
                 showCustomAlert(drawMsg); 
            } else if (game.in_check()) {
                showCustomAlert(`${game.turn() === 'w' ? 'White' : 'Black'}'s King is in Check!`, 2000);
            }

            if (!game.game_over() && gameMode === 'bot' && game.turn() === 'b' && !awaitingPromotion) {
                makeBotMove();
            }
        }
        function showPromotionUI(fromSq, toSq) { 
            awaitingPromotion = true;
            promotionDetails = { from: fromSq, to: toSq };
            promotionPopup.style.display = 'block';
            updateStatus(); 
        }
        promotionOptionsElement.addEventListener('click', (event) => { 
            const button = event.target.closest('button');
            if (!button || !button.dataset.promote || !awaitingPromotion || !promotionDetails) return;
            const promotionPiece = button.dataset.promote;
            const moveResult = game.move({
                from: promotionDetails.from,
                to: promotionDetails.to,
                promotion: promotionPiece
            });
            promotionPopup.style.display = 'none';
            awaitingPromotion = false;
            promotionDetails = null;
            if (moveResult) {
                afterMove();
            } else {
                console.error("Promotion move was invalid after selection.");
                showCustomAlert("Invalid promotion move attempt.", 2500, true);
                selectedSquare = null; 
                validMoves = [];
                renderBoard(); 
            }
        });
        function handleSquareClick(event) { 
            if (game.game_over() || isBotThinking || awaitingPromotion) return;
            if (gameMode === 'bot' && game.turn() === 'b') return; 
            const clickedSquareEl = event.target.closest('.square');
            if (!clickedSquareEl) return;
            const clickedSquareName = clickedSquareEl.dataset.square;
            if (!selectedSquare) { 
                const piece = game.get(clickedSquareName);
                if (piece && piece.color === game.turn()) {
                    selectedSquare = clickedSquareName;
                    validMoves = game.moves({ square: selectedSquare, verbose: true });
                    renderBoard();
                }
            } else { 
                const pieceToMove = game.get(selectedSquare);
                const targetRankForPromotion = (pieceToMove.color === 'w') ? '8' : '1';
                if (pieceToMove.type === 'p' && clickedSquareName[1] === targetRankForPromotion) {
                    const isActualPromotionMove = validMoves.some(m => m.to === clickedSquareName && (m.flags.includes('np') || m.flags.includes('cp'))); // np for non-capture promotion, cp for capture-promotion
                    if (isActualPromotionMove) {
                        showPromotionUI(selectedSquare, clickedSquareName);
                        selectedSquare = null; 
                        validMoves = [];
                        renderBoard(); 
                        return; // Wait for promotion choice
                    }
                }
                // Attempt the move
                let moveObject = { from: selectedSquare, to: clickedSquareName };
                // If it's a pawn reaching the promotion rank but not yet handled by showPromotionUI (e.g. if isActualPromotionMove was false but still a valid move),
                // chess.js might still require a promotion parameter. Default to Queen.
                if (pieceToMove.type === 'p' && clickedSquareName[1] === targetRankForPromotion && validMoves.some(m => m.to === clickedSquareName)) {
                    moveObject.promotion = 'q'; 
                }

                const moveResult = game.move(moveObject);
                if (moveResult) {
                    selectedSquare = null;
                    validMoves = [];
                    afterMove();
                } else { // Invalid move or clicked on own piece again
                    selectedSquare = null;
                    validMoves = [];
                    const pieceOnTarget = game.get(clickedSquareName);
                    if (pieceOnTarget && pieceOnTarget.color === game.turn()) { 
                        selectedSquare = clickedSquareName; // Select the new piece
                        validMoves = game.moves({ square: selectedSquare, verbose: true });
                    }
                    renderBoard(); 
                }
            }
        }
        
        resetGameButton.addEventListener('click', resetCurrentBoard);
        shareButton.addEventListener('click', () => { 
            const shareText = "Play chess! Check out this awesome GameVerse game by Kanhaiya Mishra: " + window.location.href;
            window.open("https://api.whatsapp.com/send?text=" + encodeURIComponent(shareText), '_blank');
        });
        playFriendButton.addEventListener('click', () => { 
            botDifficultySelectorDiv.style.display = 'none';
            startGameBotFinalButton.style.display = 'none';
            playBotInitialButton.style.display = 'inline-block'; 
            startGame('friend');
        });
        playBotInitialButton.addEventListener('click', () => { 
            botDifficultySelectorDiv.style.display = 'block';
            startGameBotFinalButton.style.display = 'inline-block';
            playBotInitialButton.style.display = 'none';
            playFriendButton.style.display = 'none';
        });
        startGameBotFinalButton.addEventListener('click', () => { 
            startGame('bot');
        });
        backButton.addEventListener('click', goBackToMainMenu);
        
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        createBoardHTML();
        loadSavedTheme(); 
        goBackToMainMenu(); 

        // === END OF JAVASCRIPT ===
    </script>
</body>
</html>
